<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InfraQuiz - Local Test</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/7.2.0/mdb.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="styles.css" rel="stylesheet">
</head>
<body>
    <div class="container py-5">
        <h1 class="text-center mb-4">üß™ Local Parser Test</h1>
        
        <div class="row">
            <div class="col-md-6">
                <h3>Test Markdown Content</h3>
                <textarea id="testContent" class="form-control" rows="15" placeholder="Paste markdown content here...">
# üêö Bash Scripting - Questions 1

## Questions

### 1. ‚ùì What's the correct way to check if a file exists in Bash? üü¢

A) üìù `if [ -f "file.txt" ]; then`

B) üîÑ if file "file.txt" exists; then

C) üì¶ if exists "file.txt"; then

D) üéØ if check "file.txt"; then

**Correct Answer**: A) üìù `if [ -f "file.txt" ]; then`

> üí° The `-f` test operator checks if a file exists and is a regular file.

### 2. üß† How do you assign a value to a variable in Bash? üü¢

A) üìù `variable=value` (no spaces)

B) üîÑ variable = value (with spaces)

C) üì¶ set variable=value

D) üéØ let variable=value

**Correct Answer**: A) üìù `variable=value` (no spaces)

> ‚ö° Bash variable assignment requires NO spaces around the equals sign.
                </textarea>
                <button onclick="testParser()" class="btn btn-primary mt-2">Test Parser</button>
                <button onclick="loadRealContent()" class="btn btn-outline-primary mt-2">Load Real Content</button>
            </div>
            
            <div class="col-md-6">
                <h3>Results</h3>
                <div id="results" class="border p-3" style="min-height: 400px; overflow-y: auto;"></div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        function log(message) {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = 'mb-2 p-2 border-bottom';
            div.innerHTML = `<small class="text-muted">${new Date().toLocaleTimeString()}</small><br>${message}`;
            results.appendChild(div);
            results.scrollTop = results.scrollHeight;
        }
        
        function testParser() {
            const content = document.getElementById('testContent').value;
            log('üß™ Testing parser with provided content...');
            
            if (!window.InfraQuiz?.parseMarkdownQuiz) {
                log('‚ùå InfraQuiz.parseMarkdownQuiz not available');
                return;
            }
            
            try {
                const questions = window.InfraQuiz.parseMarkdownQuiz(content);
                log(`‚úÖ Parser found ${questions.length} questions`);
                
                questions.forEach((q, i) => {
                    log(`<strong>Question ${i+1}:</strong> ${q.text.substring(0, 50)}...`);
                    log(`- Difficulty: ${q.difficulty}`);
                    log(`- Options: ${q.options.length}`);
                    log(`- Correct: ${q.options.find(opt => opt.isCorrect)?.text?.substring(0, 30)}...`);
                    log(`- Explanation: ${q.explanation?.substring(0, 50)}...`);
                    log('---');
                });
                
            } catch (error) {
                log(`‚ùå Parser error: ${error.message}`);
                console.error('Full error:', error);
            }
        }
        
        async function loadRealContent() {
            log('üì° Loading real content from repository...');
            
            try {
                const response = await fetch('../quizzes/bash/en/questions1.md');
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const content = await response.text();
                document.getElementById('testContent').value = content;
                log(`‚úÖ Loaded ${Math.round(content.length / 1024)}KB from local file`);
                
                // Auto test
                setTimeout(testParser, 500);
                
            } catch (error) {
                log(`‚ùå Failed to load real content: ${error.message}`);
                log('üí° Trying GitHub instead...');
                
                try {
                    const githubUrl = 'https://raw.githubusercontent.com/jersonmartinez/InfraQuiz/main/quizzes/bash/en/questions1.md';
                    const response = await fetch(githubUrl);
                    
                    if (!response.ok) {
                        throw new Error(`GitHub HTTP ${response.status}`);
                    }
                    
                    const content = await response.text();
                    document.getElementById('testContent').value = content;
                    log(`‚úÖ Loaded ${Math.round(content.length / 1024)}KB from GitHub`);
                    
                    // Auto test
                    setTimeout(testParser, 500);
                    
                } catch (githubError) {
                    log(`‚ùå GitHub also failed: ${githubError.message}`);
                }
            }
        }
        
        window.addEventListener('load', () => {
            setTimeout(() => {
                if (window.InfraQuiz) {
                    log('üöÄ InfraQuiz loaded successfully');
                    log('Available functions: ' + Object.keys(window.InfraQuiz).join(', '));
                    
                    // Auto-load real content
                    loadRealContent();
                } else {
                    log('‚ùå InfraQuiz not loaded');
                }
            }, 1000);
        });
    </script>
</body>
</html> 